#/bin/bash

lines="place,0010080100001000,66.35,100,BID,IOC
vwap,0010080100001000,100,ASK,DAY,1572635435,1572636435,0.33,N,66.35
vwap,0010080100001000,100,ASK,DAY,1572635435,1572636435,0.33,Y
place,0010080100001000,0.0,100,BID,IOC
place,0010080100001000,0.0000001,100,BID,IOC
place,0010080100001000,-0.0000001,100,BID,IOC
place,0010080100001000,415.9999999999,100,BID,IOC
place,0010080100001000,-415.9999999999,100,BID,IOC
place,0010080100001000,312.99999999,100,BID,IOC
place,0010080100001000,-312.99999999,100,BID,IOC
place,0010080100001000,12555546.58,100,BID,IOC
place,0010080100001000,-12555546.58,100,BID,IOC
place,0010080100001000,66.35,0,BID,IOC
place,0010080100001000,66.35,100,BID,IOC
place,0010080100001000,66.35,12555546,BID,IOC
place,0010080100001000,66.35,-12555546,BID,IOC
exit"

first="true"

if [ ! -z ${FAKE_VENUE+x} ] ; then
    $PYTHON -c "import baml_fake_venue as fake_venue; fake_venue.run()" &

    SERVER=$!
fi

{
    for line in $lines
        do if [[ $first == "true" ]]
        then
            sleep 3
            first="false"
        else
            sleep 1
        fi
        echo $line
    done
} | $PYTHON $CMD_UTIL_PATH --symbology $SYMBOLOGY_PATH --session $CFG_PATH --license $FM_LICENSE_PATH

if [ ! -z ${FAKE_VENUE+x} ] ; then
    kill -SIGINT $SERVER;
fi
